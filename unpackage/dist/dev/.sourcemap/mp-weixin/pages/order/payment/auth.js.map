{"version":3,"sources":["webpack:///D:/pro/techang/uniapp-mb/main.js","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue?53ce","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue?e052","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue?a4d6","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue?0107","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue?9c73","webpack:///D:/pro/techang/uniapp-mb/pages/order/payment/auth.vue?d59b"],"names":["createPage","Page","data","type","openid","orderId","state","onLoad","options","order_id","money","Number","uid","$common","getQueryString","getCode","methods","code","getOpenId","console","log","params","scope","Api","apiCall","order","authCodeToOpenid","res","login","$db","set","userInfo","tokenHead","token","uni","switchTab","url","errorToShow","checkWXJSBridge","that","interval","setInterval","window","WeixinJSBridge","clearTimeout","onBridgeReady","_this","invoke","appId","appid","timeStamp","nonceStr","package","signType","paySign","err_msg","successToShow","setTimeout","redirectTo","id","toPayHandler","payment_code","payment_type","trade_type","recharge","formid","$api","pay","msg"],"mappings":"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","file":"pages/order/payment/auth.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'\nimport Page from './pages/order/payment/auth.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./auth.vue?vue&type=template&id=a8ddb7d4&\"\nvar renderjs\nimport script from \"./auth.vue?vue&type=script&lang=js&\"\nexport * from \"./auth.vue?vue&type=script&lang=js&\"\nimport style0 from \"./auth.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Downloads\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('a8ddb7d4')) {\n      api.createRecord('a8ddb7d4', component.options)\n    } else {\n      api.reload('a8ddb7d4', component.options)\n    }\n    module.hot.accept(\"./auth.vue?vue&type=template&id=a8ddb7d4&\", function () {\n      api.rerender('a8ddb7d4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"pro/techang/uniapp-mb/pages/order/payment/auth.vue\"\nexport default component.exports","export * from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=template&id=a8ddb7d4&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  data() {\n    return {\n      type: '',\n      openid: '',\n      orderId: '',\n      state: ''\n    }\n  },\n  onLoad(options) {\n    this.orderId = options.order_id\n    this.money = Number(options.money)\n    this.type = Number(options.type)\n    this.uid = Number(options.uid)\n    this.state = this.$common.getQueryString('state')\n    this.getCode()\n  },\n  methods: {\n    getCode() {\n      var code = this.$common.getQueryString('code')\n      code && this.getOpenId(code)\n    },\n    async getOpenId(code) {\n      console.log(code)\n      let params = {\n        code: code,\n        scope: 2,\n        state: this.state\n      }\n      //模拟接口\n      let res = await Api.apiCall('get',Api.order.authCodeToOpenid,params);\n      console.log(res);\n      if (res) {\n            this.login(data);\n            console.log(data);\n            this.$db.set('userInfos', data.userInfo);\n            this.$db.set('token', data.tokenHead+data.token);\n            uni.switchTab({\n              url: '/pages/index/index'\n            });\n\n          //this.openid = res.data\n        //  this.toPayHandler('wechatpay')\n        } else {\n          this.$common.errorToShow(res)\n        }\n\n    },\n    checkWXJSBridge(data) {\n      let that = this\n      let interval = setInterval(() => {\n        if (typeof window.WeixinJSBridge != 'undefined') {\n          clearTimeout(interval)\n          that.onBridgeReady(data)\n        }\n      }, 200)\n    },\n    onBridgeReady(data) {\n      var _this = this\n      window.WeixinJSBridge.invoke(\n        'getBrandWCPayRequest',\n        {\n          appId: data.appid, // 公众号名称，由商户传入\n          timeStamp: data.timeStamp, // 时间戳，自1970年以来的秒数\n          nonceStr: data.nonceStr, // 随机串\n          package: data.package,\n          signType: data.signType, // 微信签名方式：\n          paySign: data.paySign // 微信签名\n        },\n        function(res) {\n          if (res.err_msg === 'get_brand_wcpay_request:ok') {\n            _this.$common.successToShow('支付成功')\n          } else if (res.err_msg === 'get_brand_wcpay_request:cancel') {\n            _this.$common.errorToShow('取消支付')\n          } else {\n            _this.$common.errorToShow('支付失败')\n          }\n          setTimeout(() => {\n            _this.$common.redirectTo(\n              '/pages/order/payment/result?id=' + data.id\n            )\n          },1000)\n        }\n      )\n    },\n    toPayHandler(code) {\n      let data = {\n        payment_code: code,\n        payment_type: this.type\n      }\n\t  data['ids'] = (this.type == 1 || this.type == 5 || this.type == 6) ? this.orderId : this.uid\n      //data['ids'] = this.type == 1 ? this.orderId : this.uid\n\n      if (this.type == 1 && this.orderId) {\n        // 微信jsapi支付\n        if (this.openid) {\n          data['params'] = {\n            trade_type: 'JSAPI_OFFICIAL',\n            openid: this.openid\n          }\n        }\n      } else if (this.type == 2 && this.money) {\n        if (this.openid) {\n          data['params'] = {\n            trade_type: 'JSAPI_OFFICIAL',\n            money: this.money,\n            openid: this.openid\n          }\n        }\n      }else if ((this.type == 5 || this.type == 6) && this.recharge) {\n\t\tdata['params'] = {\n\t\t\ttrade_type: 'JSAPI_OFFICIAL',\n\t\t\topenid: this.openid,\n\t\t\tformid: this.orderId\n\t\t}\n\t  }\n      this.$api.pay(data, res => {\n        if (res.code == 200) {\n          const data = res.data\n          this.checkWXJSBridge(data)\n        } else {\n          this.$common.errorToShow(res.msg)\n        }\n      })\n    }\n  }\n}\n","import mod from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}